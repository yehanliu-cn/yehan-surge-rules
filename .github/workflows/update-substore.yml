name: Update Sub-Store Subscription

on:
  push:
    branches: [ master ]
  workflow_dispatch:

jobs:
  substore:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Ensure folders exist
        run: |
          mkdir -p source/custom/Advertising
          mkdir -p output

      - name: Download Surge subscription from Sub‑Store
        run: |
          # 用你自己的 Collection ID 替换这里的 MySub
          curl -sSL "https://sub.store/download/collection/MySub" \
            -o output/substore.list

      - name: Preview first lines
        run: head -n5 output/substore.list

      - name: Commit & Push substore.list
        uses: EndBug/add-and-commit@v9
        with:
          message: chore: update substore.list
          add: output/substore.list
